<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial 3: Visualize the results • DRDNetPro</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Tutorial 3: Visualize the results">
<meta property="og:description" content="DRDNetPro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">DRDNetPro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/NAME-OF-VIGNETTE.html">Tutorial summary</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../../articles/web/Tutorial1.html">Tutorial 1</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../../articles/web/Tutorial2.html">Tutorial 2</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../../articles/web/Tutorial3.html">Tutorial 3</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Functions</a>
</li>
<li>
  <a href="../../articles/web/data.html">Data</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chencxxy28/DRDNetPro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tutorial 3: Visualize the results</h1>
                        <h4 data-toc-skip class="author">Chixiang
Chen</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/chencxxy28/DRDNetPro/blob/HEAD/vignettes/web/Tutorial3.Rmd" class="external-link"><code>vignettes/web/Tutorial3.Rmd</code></a></small>
      <div class="hidden name"><code>Tutorial3.Rmd</code></div>

    </div>

    
    
<p><strong>DRDNetPro</strong> is a bio-protocol for recovering disease
risk-associated pseudo-dynamic networks (DRDNet) from steady-state data.
It incorporates risk prediction model of having certain disease, a
varying coefficient model, multiple ordinary differential equations, and
group lasso estimation to learn a series of networks. This tutorial will
provide detailed information for the third step of implementing the <a href="https://academic.oup.com/bioinformatics/article-abstract/38/9/2481/6537533" class="external-link">DRDNet</a>.</p>
<p>This tutorial provides some demo codes to visualize the results from
network learning in Tutorial 2. If the user hasn’t gone through the
Tutorial 2, please visit <a href="https://chencxxy28.github.io/DRDNetPro/articles/web/Tutorial2.html">Tutorial
2</a> for the second step of training the network model.</p>
<p>To begin with, load the following packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org" class="external-link">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="va">readRDSFromWeb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ref</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gzcon.html" class="external-link">gzcon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="va">ref</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="section level1">
<h1 id="load-the-output-data-of-the-network-learing-from-tutorial-2-">Load the output data of the network learing from Tutorial 2.<a class="anchor" aria-label="anchor" href="#load-the-output-data-of-the-network-learing-from-tutorial-2-"></a>
</h1>
<p>The data we need to use in this tutorial is <a href="https://github.com/chencxxy28/DRDNetPro/raw/main/vignettes/data/network.output.rds" class="external-link">network.output</a>,
<a href="https://github.com/chencxxy28/DRDNetPro/raw/main/vignettes/data/data.list.t3.rds" class="external-link">data.list.t3</a>,
and <a href="https://github.com/chencxxy28/DRDNetPro/raw/main/vignettes/data/85_gene_name_information.csv" class="external-link">85_gene_name_information</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">##need data</span>
<span class="va">network.output</span><span class="op">&lt;-</span><span class="fu">readRDSFromWeb</span><span class="op">(</span><span class="st">"https://github.com/chencxxy28/DRDNetPro/raw/main/vignettes/data/network.output.rds"</span><span class="op">)</span>
<span class="va">data.list.t3</span><span class="op">&lt;-</span><span class="fu">readRDSFromWeb</span><span class="op">(</span><span class="st">"https://github.com/chencxxy28/DRDNetPro/raw/main/vignettes/data/data.list.t3.rds"</span><span class="op">)</span>
<span class="va">gene_exact_names</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"https://github.com/chencxxy28/DRDNetPro/raw/main/vignettes/data/85_gene_name_information.csv"</span><span class="op">)</span></code></pre></div>
<p>Extract detailed data about the gene expression, covariate vector,
imputed agent, self-node size for baseline, self-node size for covariate
effect, overall self-node size, gene interaction effects from the
baseline, gene interaction effects from the covariate, overall gene
interaction effects, smoking effect, trend effect for baseline, trend
effect from covariate.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_observe</span><span class="op">&lt;-</span><span class="va">data.list.t3</span><span class="op">$</span><span class="va">data_observe</span>
<span class="va">x_cov</span><span class="op">&lt;-</span><span class="va">data.list.t3</span><span class="op">$</span><span class="va">x_cov</span>
<span class="va">agent</span><span class="op">&lt;-</span><span class="va">data.list.t3</span><span class="op">$</span><span class="va">agent</span>

<span class="va">self_size</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">self_size</span>
<span class="va">self_size_cov</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">self_size_cov</span>
<span class="va">self_size_all</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">self_size_all</span>

<span class="va">gene_whole_cov</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">gene_whole_cov</span>
<span class="va">gene_whole_all</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">gene_whole_all</span>
<span class="va">gene_whole</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">gene_whole</span>

<span class="va">smoking_effect_all</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">smoking_effect_all</span>
<span class="va">trend_base_all</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">trend_base_all</span>
<span class="va">trend_smoking_effect_all</span><span class="op">&lt;-</span><span class="va">network.output</span><span class="op">$</span><span class="va">trend_smoking_effect_all</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="visualize-the-pseudo-dynamic-network-given-some-range-of-agent-values">Visualize the pseudo dynamic network given some range of agent
values<a class="anchor" aria-label="anchor" href="#visualize-the-pseudo-dynamic-network-given-some-range-of-agent-values"></a>
</h1>
<div class="section level2">
<h2 id="visualize-the-baseline-network-when-the-agent-risk-of-having-hypertension-becomes-high">Visualize the baseline network when the agent (risk of having
hypertension) becomes high<a class="anchor" aria-label="anchor" href="#visualize-the-baseline-network-when-the-agent-risk-of-having-hypertension-becomes-high"></a>
</h2>
<p>To visualize the pseudo dynamic network given an agent (disease risk)
value, a useful tool is the <code>igraph</code> package. It allows the
self-designed network structure. More detailed tutorial about igraph can
be found in <a href="https://kateto.net/networks-r-igraph" class="external-link">igraph</a>.
The following is a demo code for visualizing the recovered baseline
network for non-smoking group, where the agent (risk of having
hypertension) is changing from 0 (no risk) to 0.86 (high risk).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">##network for x=0 at i=250 after some tuning</span>
<span class="va">tunned_value</span><span class="op">&lt;-</span><span class="fl">0.03</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span><span class="op">)</span>
<span class="op">{</span>
    <span class="va">tunning_index</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">gene_whole_all</span>,<span class="fl">1</span>,<span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">&gt;=</span><span class="va">tunned_value</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
    <span class="va">gene_whole_all_tuned</span><span class="op">&lt;-</span><span class="va">gene_whole_all</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tunning_index</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,<span class="op">]</span>
    <span class="va">tunning_index</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">gene_whole</span>,<span class="fl">1</span>,<span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">&gt;=</span><span class="va">tunned_value</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
    <span class="va">gene_whole_tuned</span><span class="op">&lt;-</span><span class="va">gene_whole</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tunning_index</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,<span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gene_whole_tuned</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
    <span class="co">#geneate link data with 25th tissue</span>
    <span class="va">links_gene</span><span class="op">&lt;-</span><span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"from"</span>,<span class="st">"to"</span>,<span class="st">"tissue_name"</span><span class="op">)</span>
    <span class="va">links_gene</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span>
    <span class="va">links_gene</span><span class="op">$</span><span class="va">edge_type</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span><span class="op">)</span>
    
    <span class="va">self_index_all</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gene_whole_all_tuned</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">gene_whole_all_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="va">self_index</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">gene_whole_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="co">#nodes_gene&lt;-data.frame(cbind(self_index,self_size[self_index,(i+1)]))</span>
    <span class="va">nodes_gene</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">self_size</span><span class="op">[</span><span class="va">self_size</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">self_index</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">nodes_gene</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"self_weight"</span><span class="op">)</span>
    <span class="co">#nodes_gene&lt;-data.frame(self_size[,c((i+1))])</span>
    <span class="co">#colnames(nodes_gene)&lt;-c("self_weight")</span>
    <span class="va">nodes_gene</span><span class="op">$</span><span class="va">node_type</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nodes_gene</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">39</span>,<span class="fl">40</span>,<span class="fl">48</span>,<span class="fl">64</span>,<span class="fl">76</span><span class="op">)</span>,<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nodes_gene</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="va">self_index</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
    
    <span class="co">#nodes_gene$node_type&lt;-ifelse(nodes_gene$id %in% self_index,3,4)</span>
    <span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html" class="external-link">graph.data.frame</a></span><span class="op">(</span><span class="va">links_gene</span>, <span class="va">nodes_gene</span>, directed<span class="op">=</span><span class="cn">T</span><span class="op">)</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span>
    <span class="va">net</span> 
    
    <span class="co"># It's easy to access nodes, edges, and their attributes:</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">self_weight</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">tissue_name</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span> <span class="co">#total 47 clusters included in the network</span>
    
    <span class="co"># Now we should be able to do this:</span>
    <span class="co">#plot(net, edge.arrow.size=.2,vertex.label.family="Arial Black" )</span>
    
    <span class="co">#adjust size of nodes and width of edges</span>
    <span class="va">colrs_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"orange"</span>,<span class="st">"gray"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="va">colrs_nodes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">node_type</span><span class="op">]</span>
    <span class="va">colrs_edge</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span>,<span class="st">"gray40"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="va">colrs_edge</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">edge_type</span><span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">self_weight</span><span class="op">)</span><span class="op">^</span><span class="fl">0.7</span><span class="op">*</span><span class="fl">4</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">width</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">tissue_name</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">0.4</span><span class="op">*</span><span class="fl">10</span>
    
    <span class="co">#change coordinate to separate the nodes</span>
    
    <span class="co">#set.seed(41414343)</span>
    <span class="va">net.bg</span><span class="op">&lt;-</span><span class="va">net</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4151320</span><span class="op">)</span>
    <span class="va">l</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html" class="external-link">layout_nicely</a></span><span class="op">(</span><span class="va">net.bg</span><span class="op">)</span>
    <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/norm_coords.html" class="external-link">layout.norm</a></span><span class="op">(</span><span class="va">l</span>, ymin<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, ymax<span class="op">=</span><span class="fl">1</span>, xmin<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, xmax<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
    <span class="va">l</span><span class="op">[</span><span class="fl">20</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.9</span>,<span class="fl">0.1</span><span class="op">)</span>
    <span class="va">l</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>
    <span class="va">l</span><span class="op">[</span><span class="fl">46</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span><span class="op">)</span>
    <span class="va">l</span><span class="op">[</span><span class="fl">8</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span><span class="op">)</span>
    <span class="co">#l&lt;-layout_in_circle(net.bg)</span>
    <span class="co">#l&lt;-layout_as_star(net.bg,center=V(net)[1:3])</span>
    <span class="co">#l&lt;-layout_as_bipartite(net.bg)</span>
    <span class="co">#l&lt;-layout_on_grid(net.bg)</span>
    <span class="co">#l&lt;-layout_on_sphere(net.bg)</span>
    <span class="co">#l&lt;-layout_with_sugiyama(net.bg)</span>
    <span class="co">#l&lt;-layout_with_dh(net.bg)</span>
    <span class="co"># Normalize them so that they are in the -1, 1 interval:</span>
    <span class="co">#l &lt;- layout.norm(l, ymin=-1, ymax=1, xmin=-1, xmax=1)</span>
    <span class="va">gene_names_used</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">gene_exact_names</span><span class="op">$</span><span class="va">gene.name</span><span class="op">[</span><span class="va">nodes_gene</span><span class="op">$</span><span class="va">id</span><span class="op">]</span><span class="op">)</span>
    <span class="co">#gene_names_used[which(gene_names_used=="CTSD\xca")]&lt;-"CTSD"</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/plot.igraph.html" class="external-link">plot.igraph</a></span><span class="op">(</span><span class="va">net.bg</span>, rescale<span class="op">=</span><span class="cn">F</span>, layout<span class="op">=</span><span class="va">l</span>,edge.arrow.size<span class="op">=</span><span class="fl">1</span>, edge.curved<span class="op">=</span><span class="fl">.2</span>,vertex.label<span class="op">=</span><span class="va">gene_names_used</span>,
                vertex.label.color<span class="op">=</span><span class="st">"blue"</span>,vertex.label.cex<span class="op">=</span><span class="fl">1</span>,mark.border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="Tutorial3_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="visualize-three-covariate-effect-smoking-networks-when-the-agent-risk-of-having-hypertension-becomes-low-moderate-and-high-respectively-">Visualize three covariate-effect (smoking) networks when the agent
(risk of having hypertension) becomes low, moderate, and high,
respectively.<a class="anchor" aria-label="anchor" href="#visualize-three-covariate-effect-smoking-networks-when-the-agent-risk-of-having-hypertension-becomes-low-moderate-and-high-respectively-"></a>
</h2>
<p>The following is a demo code for visualizing three recovered
covariate-effect (effect caused by smoking) networks, where the agent
(risk of having hypertension) is changing from 0 (no risk) to 0.10 (low
risk), from 0 (no risk) to 0.42 (moderate risk), and from 0 (no risk) to
0.86 (high risk).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">tunned_value</span><span class="op">&lt;-</span><span class="fl">0.01</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">100</span>,<span class="fl">250</span><span class="op">)</span><span class="op">)</span>
<span class="op">{</span>
    <span class="va">tunning_index</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">gene_whole_cov</span>,<span class="fl">1</span>,<span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">&gt;=</span><span class="va">tunned_value</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
    <span class="va">gene_whole_cov_tuned</span><span class="op">&lt;-</span><span class="va">gene_whole_cov</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tunning_index</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>,<span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gene_whole_cov_tuned</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">gene_whole_cov_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">gene_whole_cov_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>
    <span class="co">#geneate link data with 25th tissue</span>
    <span class="va">links_gene</span><span class="op">&lt;-</span><span class="va">gene_whole_cov_tuned</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"from"</span>,<span class="st">"to"</span>,<span class="st">"tissue_name"</span><span class="op">)</span>
    <span class="va">links_gene</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span>
    <span class="va">links_gene</span><span class="op">$</span><span class="va">edge_type</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">gene_whole_cov_tuned</span><span class="op">[</span>,<span class="va">i</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">links_gene</span><span class="op">)</span><span class="op">)</span>
    
    <span class="co">#self_index_all&lt;-unique(c(gene_whole_tuned[,1],gene_whole_tuned[,2],gene_whole_cov_tuned[,1],gene_whole_cov_tuned[,2]))</span>
    <span class="va">self_index_cov</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gene_whole_cov_tuned</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">gene_whole_cov_tuned</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="va">self_index_all</span><span class="op">&lt;-</span><span class="va">self_index_cov</span>
    <span class="co">#nodes_gene&lt;-data.frame(cbind(self_index,self_size[self_index,(i+1)]))</span>
    <span class="va">nodes_gene</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">self_size_cov</span><span class="op">[</span><span class="va">self_size_cov</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">self_index_all</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">nodes_gene</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"self_weight"</span><span class="op">)</span>
    <span class="co">#nodes_gene&lt;-data.frame(self_size[,c((i+1))])</span>
    <span class="co">#colnames(nodes_gene)&lt;-c("self_weight")</span>
    <span class="va">nodes_gene</span><span class="op">$</span><span class="va">node_type</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nodes_gene</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">(</span><span class="va">self_index_cov</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>
    <span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html" class="external-link">graph.data.frame</a></span><span class="op">(</span><span class="va">links_gene</span>, <span class="va">nodes_gene</span>, directed<span class="op">=</span><span class="cn">T</span><span class="op">)</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span>
    <span class="va">net</span> 
    
    <span class="co"># It's easy to access nodes, edges, and their attributes:</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">self_weight</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">tissue_name</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span> <span class="co">#total 34 clusters included in the network</span>
    
    <span class="co"># Now we should be able to do this:</span>
    <span class="co">#plot(net, edge.arrow.size=.2,vertex.label.family="Arial Black" )</span>
    
    <span class="co">#adjust size of nodes and width of edges</span>
    <span class="va">colrs_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>,<span class="st">"orange"</span>,<span class="st">"gray"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="va">colrs_nodes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">node_type</span><span class="op">]</span>
    <span class="va">colrs_edge</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span>,<span class="st">"gray40"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="va">colrs_edge</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">edge_type</span><span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">self_weight</span><span class="op">)</span><span class="op">^</span><span class="fl">0.7</span><span class="op">*</span><span class="fl">4</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">width</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">$</span><span class="va">tissue_name</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">0.4</span><span class="op">*</span><span class="fl">10</span>
    <span class="va">net.bg</span><span class="op">&lt;-</span><span class="va">net</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4151320</span><span class="op">)</span>
    <span class="va">l</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html" class="external-link">layout_nicely</a></span><span class="op">(</span><span class="va">net.bg</span><span class="op">)</span>
    <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/norm_coords.html" class="external-link">layout.norm</a></span><span class="op">(</span><span class="va">l</span>, ymin<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, ymax<span class="op">=</span><span class="fl">1</span>, xmin<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, xmax<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
    <span class="co"># Normalize them so that they are in the -1, 1 interval:</span>
    <span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/norm_coords.html" class="external-link">layout.norm</a></span><span class="op">(</span><span class="va">l</span>, ymin<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, ymax<span class="op">=</span><span class="fl">1</span>, xmin<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, xmax<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
    <span class="va">gene_names_used</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">gene_exact_names</span><span class="op">$</span><span class="va">gene.name</span><span class="op">[</span><span class="va">nodes_gene</span><span class="op">$</span><span class="va">id</span><span class="op">]</span><span class="op">)</span>
    <span class="va">gene_names_used</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">gene_names_used</span><span class="op">==</span><span class="st">"CTSD\xca"</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"CTSD"</span>
    <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/plot.igraph.html" class="external-link">plot.igraph</a></span><span class="op">(</span><span class="va">net.bg</span>, rescale<span class="op">=</span><span class="cn">F</span>, layout<span class="op">=</span><span class="va">l</span><span class="op">*</span><span class="fl">0.9</span>,edge.arrow.size<span class="op">=</span><span class="fl">1</span>, edge.curved<span class="op">=</span><span class="fl">.2</span>,vertex.label<span class="op">=</span><span class="va">gene_names_used</span>,
                vertex.label.color<span class="op">=</span><span class="st">"blue"</span>,vertex.label.cex<span class="op">=</span><span class="fl">1.5</span>,mark.border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
<span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="Tutorial3_files/figure-html/unnamed-chunk-5-1.png" width="1152"></p>
</div>
</div>
<div class="section level1">
<h1 id="visualize-the-interaction-behaviors-from-other-genes-to-the-gene-of-interest-over-the-spectrum-of-the-agent-risk-of-having-hypertension">Visualize the interaction behaviors from other genes to the gene of
interest over the spectrum of the agent (risk of having
hypertension)<a class="anchor" aria-label="anchor" href="#visualize-the-interaction-behaviors-from-other-genes-to-the-gene-of-interest-over-the-spectrum-of-the-agent-risk-of-having-hypertension"></a>
</h1>
<div class="section level2">
<h2 id="for-the-baseline-group-non-smoking-group">For the baseline group (non-smoking group)<a class="anchor" aria-label="anchor" href="#for-the-baseline-group-non-smoking-group"></a>
</h2>
<p>Select the gene of interest (C3orf70) and extract related results</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#select a gene: C3orf70</span>
<span class="va">index.gene</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">gene_exact_names</span><span class="op">$</span><span class="va">gene.name</span><span class="op">==</span><span class="st">"C3orf70"</span><span class="op">)</span>

<span class="co">#extract information about the target gene and affecting genes</span>
<span class="va">gene_select_data</span><span class="op">&lt;-</span><span class="va">gene_whole</span><span class="op">[</span><span class="va">gene_whole</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="va">index.gene</span>,<span class="op">]</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="va">affecting_genes</span><span class="op">&lt;-</span><span class="va">gene_whole</span><span class="op">[</span><span class="va">gene_whole</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="va">index.gene</span>,<span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">magnitude</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">gene_select_data</span>,<span class="fl">1</span>,<span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">gene_select_data_tuned</span><span class="op">&lt;-</span><span class="va">gene_select_data</span><span class="op">[</span><span class="va">magnitude</span><span class="op">&gt;=</span><span class="fl">0.02</span>,<span class="op">]</span>
<span class="va">affecting_genes_tuned</span><span class="op">&lt;-</span><span class="va">affecting_genes</span><span class="op">[</span><span class="va">magnitude</span><span class="op">&gt;=</span><span class="fl">0.02</span><span class="op">]</span>
<span class="va">name_affectgene</span><span class="op">&lt;-</span><span class="va">gene_exact_names</span><span class="op">$</span><span class="va">gene.name</span><span class="op">[</span><span class="va">affecting_genes_tuned</span><span class="op">]</span></code></pre></div>
<p>Plot the trend effect for the non-smoking group as the agent
increases (risk of having hypertension). It can be seen that there is a
decreasing trend of expression.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plot trend effect</span>
<span class="va">trend_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">trend_base_all</span><span class="op">[</span>,<span class="va">index.gene</span><span class="op">]</span>,<span class="va">agent</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trend_data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trend_effect"</span>,<span class="st">"hypertension_probability"</span><span class="op">)</span>
<span class="va">trend_data</span><span class="op">$</span><span class="va">line</span><span class="op">&lt;-</span><span class="st">"trend_effect"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">trend_data</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##           trend_effect hypertension_probability         line</span>
<span class="co">## base_int   -0.05885590               0.06485799 trend_effect</span>
<span class="co">## int_row    -0.06247214               0.06884301 trend_effect</span>
<span class="co">## int_row.1  -0.06655976               0.07334748 trend_effect</span>
<span class="co">## int_row.2  -0.07189403               0.07922575 trend_effect</span>
<span class="co">## int_row.3  -0.07298267               0.08042540 trend_effect</span>
<span class="co">## int_row.4  -0.07648075               0.08428021 trend_effect</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">trend_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">hypertension_probability</span>, y<span class="op">=</span><span class="va">trend_effect</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkblue"</span>,size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Linear trend effect for the gene C3orf70"</span>, x<span class="op">=</span><span class="st">"Risk of having Hypertension"</span>, y<span class="op">=</span><span class="st">"Trend effect"</span><span class="op">)</span>
<span class="va">p1</span></code></pre></div>
<p><img src="Tutorial3_files/figure-html/unnamed-chunk-7-1.png" width="1152"></p>
<p>Plot the interaction effects from genes to the targeted gene for the
non-smoking group as the agent increases (risk of having hypertension).
It can be seen that three genes are inhibiting the expression of the
gene C3orf70</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plot interaction effects</span>
<span class="va">gene_select_data_tuned_new</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">gene_select_data_tuned</span><span class="op">)</span><span class="op">)</span>
<span class="va">gene_select_data_tuned_new</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">agent</span>,time<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"effects"</span>,<span class="st">"hypertension_probability"</span><span class="op">)</span>
<span class="va">gene_select_data_tuned_new</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span><span class="op">)</span>
<span class="va">gene_select_data_tuned_new</span><span class="op">$</span><span class="va">genes</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">name_affectgene</span>,each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">agent</span><span class="op">)</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">hypertension_probability</span>, y<span class="op">=</span><span class="va">effects</span>, color<span class="op">=</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span>,alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">agent</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>,<span class="st">"green"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Inter-behaviors to the gene C3orf70"</span>, x<span class="op">=</span><span class="st">"Risk of having Hypertension"</span>, y<span class="op">=</span><span class="st">"Effects from other genes"</span><span class="op">)</span>

<span class="va">p2</span></code></pre></div>
<p><img src="Tutorial3_files/figure-html/unnamed-chunk-8-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="for-the-smoking-group">For the smoking group<a class="anchor" aria-label="anchor" href="#for-the-smoking-group"></a>
</h2>
<p>Select the gene of interest (C3orf70) and extract related results. It
can be seen that the effect from smoking is -0.13.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#for smoking group</span>
<span class="va">gene_select_data</span><span class="op">&lt;-</span><span class="va">gene_whole_all</span><span class="op">[</span><span class="va">gene_whole_all</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="va">index.gene</span>,<span class="op">]</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="va">affecting_genes</span><span class="op">&lt;-</span><span class="va">gene_whole_all</span><span class="op">[</span><span class="va">gene_whole_all</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">==</span><span class="va">index.gene</span>,<span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">magnitude</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">gene_select_data</span>,<span class="fl">1</span>,<span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">gene_select_data_tuned</span><span class="op">&lt;-</span><span class="va">gene_select_data</span><span class="op">[</span><span class="va">magnitude</span><span class="op">&gt;=</span><span class="fl">0.02</span>,<span class="op">]</span>
<span class="va">affecting_genes_tuned</span><span class="op">&lt;-</span><span class="va">affecting_genes</span><span class="op">[</span><span class="va">magnitude</span><span class="op">&gt;=</span><span class="fl">0.02</span><span class="op">]</span>
<span class="va">name_affectgene</span><span class="op">&lt;-</span><span class="va">gene_exact_names</span><span class="op">$</span><span class="va">gene.name</span><span class="op">[</span><span class="va">affecting_genes_tuned</span><span class="op">]</span>

<span class="va">smoking_effect_all</span><span class="op">[</span><span class="va">index.gene</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">##   base_int </span>
<span class="co">## -0.1289786</span></code></pre>
<p>The above value indicates that smoking will inhibit the expression of
gene C3orf70. Plot the trend effect for the smoking group as the agent
increases (risk of having hypertension). It can be seen that there is a
decreasing trend of expression.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">smoking_effect_size</span><span class="op">&lt;-</span><span class="va">trend_smoking_effect_all</span><span class="op">[</span>,<span class="va">index.gene</span><span class="op">]</span><span class="op">+</span><span class="va">smoking_effect_all</span><span class="op">[</span><span class="va">index.gene</span><span class="op">]</span><span class="op">+</span><span class="va">trend_base_all</span><span class="op">[</span>,<span class="va">index.gene</span><span class="op">]</span>

<span class="va">trend_data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">smoking_effect_size</span>,<span class="va">agent</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">trend_data</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trend_effect"</span>,<span class="st">"hypertension_probability"</span><span class="op">)</span>
<span class="va">trend_data</span><span class="op">$</span><span class="va">line</span><span class="op">&lt;-</span><span class="st">"trend_effect"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">trend_data</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##           trend_effect hypertension_probability         line</span>
<span class="co">## base_int    -0.1944357               0.06485799 trend_effect</span>
<span class="co">## int_row     -0.1984575               0.06884301 trend_effect</span>
<span class="co">## int_row.1   -0.2030036               0.07334748 trend_effect</span>
<span class="co">## int_row.2   -0.2089362               0.07922575 trend_effect</span>
<span class="co">## int_row.3   -0.2101469               0.08042540 trend_effect</span>
<span class="co">## int_row.4   -0.2140373               0.08428021 trend_effect</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#y_limit&lt;-max(trend_data$trend_effect)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">trend_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">hypertension_probability</span>, y<span class="op">=</span><span class="va">trend_effect</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"darkblue"</span>,size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#coord_cartesian(ylim=c(0,y_limit ))+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Linear trend effect for the gene C3orf70"</span>, x<span class="op">=</span><span class="st">"Risk of having hypertension"</span>, y<span class="op">=</span><span class="st">"Trend effect"</span><span class="op">)</span>

<span class="va">p3</span></code></pre></div>
<p><img src="Tutorial3_files/figure-html/unnamed-chunk-10-1.png" width="1152"></p>
<p>Plot the interaction effects from genes to the targeted gene for the
smoking group as the agent increases (risk of having hypertension). It
can be seen, in addition to the three genes detected in non-smoking
group, one extra gene is affecting the expression of the gene C3orf70.
However, it seems that the effect from CTSD is small and wiggles around
zero.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gene_select_data_tuned_new</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">gene_select_data_tuned</span><span class="op">)</span><span class="op">)</span>
<span class="va">gene_select_data_tuned_new</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">agent</span>,time<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"effects"</span>,<span class="st">"hypertension_probability"</span><span class="op">)</span>

<span class="va">gene_select_data_tuned_new</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span><span class="op">)</span>
<span class="va">gene_select_data_tuned_new</span><span class="op">$</span><span class="va">genes</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">name_affectgene</span>,each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">agent</span><span class="op">)</span><span class="op">)</span>

<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">gene_select_data_tuned_new</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">hypertension_probability</span>, y<span class="op">=</span><span class="va">effects</span>, color<span class="op">=</span><span class="va">genes</span>, group<span class="op">=</span><span class="va">genes</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span>,alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">agent</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"purple"</span>, <span class="st">"green"</span>,<span class="st">"yellow"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Inter-behaviors to the gene C3orf70"</span>, x<span class="op">=</span><span class="st">"Risk of having hypertension"</span>, y<span class="op">=</span><span class="st">"Effects from other genes"</span><span class="op">)</span>

<span class="va">p4</span></code></pre></div>
<p><img src="Tutorial3_files/figure-html/unnamed-chunk-11-1.png" width="1152"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Chixiang Chen.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
